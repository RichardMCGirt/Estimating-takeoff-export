<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vanir Estimating Tool</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="./darkmode.css">

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="main-wrapper">
   <!-- <ol>
      <li><strong>Upload Excel (.xlsx)</strong> – source file with raw data from Planswift</li>
      <li><strong>Review Table</strong> – confirm SKUs and quantities</li>
      <li><strong>Select Elevation</strong> – choose which elevation to use</li>
    </ol> -->
<button id="darkModeToggle" style="position: fixed; top: 10px; right: 10px; z-index: 10000;"> Switch to Dark Mode</button>

    <h2>Step 1: Upload Source File</h2>
    <div id="drop-zone">
      <p>
        Drag & drop your Excel file here, or 
        <span class="click-browse">click </span> to browse
      </p>
      <input type="file" id="sourceFile" accept=".xlsx" />
    </div>

    <div id="file-name"></div>

    <hr>
    <h2>Step 2: Complete this table</h2>

<table border="1" style="border-collapse: collapse;">
 <tr>
  <td style="white-space: nowrap; width: 1%;">Builder:</td>
  <td>
    <input type="text" name="builder" id="builderInput" autocomplete="off" />
    <div id="builderDropdown" class="autocomplete-dropdown"></div>
  </td>
</tr>

  <tr>
    <td style="white-space: nowrap; width: 1%;">Plan Name:</td>
    <td><input type="text" name="planName" /></td>
  </tr>

  <tr>
    <td style="white-space: nowrap; width: 1%;">Material Type:</td>
    <td><input type="text" name="materialType" /></td>
  </tr>
<tr>
  <td style="white-space: nowrap; width: 1%;">Date:</td>
  <td><input type="date" name="date" id="dateInput" /></td>
</tr>
<tr>
  <td style="white-space: nowrap; width: 1%;">Estimator:</td>
  <td>
    <input type="text" name="estimator" id="estimatorInput" autocomplete="off" />
    <div id="estimatorDropdown" class="autocomplete-dropdown"></div>
  </td>
</tr>  
<tr>
    <td style="white-space: nowrap; width: 1%;">Paint labor:</td>
    <td><input type="number" name="paintlabor" /></td>
  </tr>

</table>
<hr>

    <div id="loadingOverlay">
      <div id="loadingMessage">Loading...</div>
      <div class="loader"></div>
    </div>

    <div id="elevationSection">
      <h2>Step 3: Select Elevation</h2>
      <div id="folderButtons"></div>
      <hr>
    </div>

    <div id="mergedTableWrapper">
      <div id="mergedTableContainer"></div>
    </div>

    <div id="toast"></div>
  </div>

  <script src="script.js"></script>
<script src="autocomplete-estimator.js"></script>
<script src="autocomplete-builder.js"></script>

  <script>
 const fields = ["builder", "planName", "elevation", "materialType", "date", "estimator"];

// ✅ Load values from localStorage into inputs on page load
document.addEventListener("DOMContentLoaded", () => {
  fields.forEach(field => {
    const input = document.querySelector(`[name="${field}"]`);
    const savedValue = localStorage.getItem(field);
    if (input && savedValue !== null) {
      input.value = savedValue;
    }

    // ✅ Default to today's date if not set and field is "date"
    if (field === "date" && input && !input.value) {
      input.value = new Date().toISOString().split("T")[0];
    }

    // ✅ Add input event listener to save to localStorage
    if (input) {
      input.addEventListener("input", () => {
        localStorage.setItem(field, input.value);
      });
    }
  });
});

</script>
</body>


</html>