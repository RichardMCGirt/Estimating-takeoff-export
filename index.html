<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vanir Estimating Tool</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="./darkmode.css">

  <!-- XLSX Library -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="main-wrapper">

    <!-- 🔘 Dark Mode Toggle Button -->
    <button id="darkModeToggle" style="position: fixed; top: 10px; right: 10px; z-index: 10000;">
      Switch to Dark Mode
    </button>

    <!-- 📁 Step 1: Upload Source File -->
    <h2>Step 1: Upload Source File</h2>
    <div id="drop-zone">
      <p>
        Drag & drop your Excel file here, or 
        <span class="click-browse">click</span> to browse
      </p>
      <input type="file" id="sourceFile" accept=".xlsx" />
    </div>
    <div id="file-name"></div>

    <hr>

    <!-- ✍️ Step 2: Complete This Table -->
    <h2>Step 2: Complete this table</h2>
    <table id="estimateForm" border="1" style="border-collapse: collapse;">
      <tr>
        <td style="white-space: nowrap; width: 1%;">Builder:</td>
        <td>
          <input type="text" name="builder" id="builderInput" autocomplete="off" />
          <div id="builderDropdown" class="autocomplete-dropdown"></div>
        </td>
      </tr>

      <tr>
        <td style="white-space: nowrap; width: 1%;">Plan Name:</td>
        <td><input type="text" name="planName" /></td>
      </tr>

      <tr>
        <td style="white-space: nowrap; width: 1%;">Material Type:</td>
        <td><input type="text" name="materialType" /></td>
      </tr>

      <tr>
        <td style="white-space: nowrap; width: 1%;">Date:</td>
        <td><input type="date" name="date" id="dateInput" /></td>
      </tr>

      <tr>
        <td style="white-space: nowrap; width: 1%;">Estimator:</td>
        <td>
          <input type="text" name="estimator" id="estimatorInput" autocomplete="off" />
          <div id="estimatorDropdown" class="autocomplete-dropdown"></div>
        </td>
      </tr>

      <tr>
        <td style="white-space: nowrap; width: 1%;">Paint labor:</td>
        <td><input type="number" name="paintlabor" /></td>
      </tr>
    </table>

    <hr>

    <!-- ⏳ Loading Overlay -->
    <div id="loadingOverlay">
      <div id="loadingMessage">Loading...</div>
      <div class="loader"></div>
    </div>

    <!-- 🏡 Step 3: Select Elevation -->
    <div id="elevationSection">
      <h2>Step 3: Select Elevation</h2>
      <div id="folderButtons"></div>
      <hr>
    </div>

    <!-- 📊 Merged Table Output -->
    <div id="mergedTableWrapper">
      <div id="mergedTableContainer"></div>
    </div>

    <!-- 🔔 Toast Notification -->
    <div id="toast"></div>
  </div>

  <!-- 📜 Scripts -->
  <script src="script.js"></script>
  <script src="autocomplete-estimator.js"></script>
  <script src="autocomplete-builder.js"></script>
</body>
</html>
