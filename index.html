<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vanir Estimating tool</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid #999; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>
  <h2>Step 1: Upload Excel (.xlsx) File</h2>
  <input type="file" id="sourceFile" accept=".xlsx" />

   <h2>Step 2: Upload Template file</h2>
  <input type="file" id="targetFile" accept=".xlsx" disabled />

  <form action="http://localhost:3001/upload-and-inject" method="POST" enctype="multipart/form-data">
    <label>Upload JSON:</label>
    <input type="file" name="jsonFile" accept=".json" required /><br /><br />
    <label>Upload XLSB Template:</label>
    <input type="file" name="xlsbFile" accept=".xlsb" required /><br /><br />
    <button type="submit">Upload & Inject</button>
  </form>
  
  <a href="http://localhost:3001/download-xlsb" target="_blank">Download Modified XLSB</a>
  
  <div id="folderButtons"></div>
  <button id="downloadJsonButton">Download merged-data.json</button>

  <button id="downloadButton" >Download Mapped takeoff template</button>
  <div id="mergedTableContainer"></div> 

  <div id="toast" style="
  position: fixed;
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: white;
  padding: 10px 20px;
  border-radius: 6px;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  z-index: 9999;
"></div>

  
  <script src ="script.js"></script> 

</body>
</html>